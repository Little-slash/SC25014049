% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{hf_step}
\alias{hf_step}
\title{Hirsch-Fye算法单步计算核心函数}
\usage{
hf_step(H0, s, U, beta)
}
\arguments{
\item{H0}{单粒子哈密顿量矩阵}

\item{s}{辅助场配置向量，长度为时间切片数L}

\item{U}{Hubbard相互作用强度}

\item{beta}{逆温度}
}
\value{
包含以下元素的列表：
  \item{Bup}{向上自旋的传播子矩阵}
  \item{Bdn}{向下自旋的传播子矩阵}
  \item{logdet}{对数行列式值，用于Metropolis接受率计算}
}
\description{
这是Hirsch-Fye量子蒙特卡洛算法的核心计算函数，使用C++实现以获得高性能。
该函数计算给定辅助场配置下的传播子和行列式。
}
\examples{
\dontrun{
# 构建哈密顿量
H0 <- build_hamiltonian(0, c(-1, 1), c(0.5, 0.5))

# 随机辅助场配置
set.seed(123)
s <- sample(c(-1, 1), 20, replace = TRUE)

# 运行单步计算
result <- hf_step(H0, s, U = 2.0, beta = 5.0)

# 查看结果
cat("对数行列式:", result$logdet, "\n")
cat("Bup矩阵维度:", dim(result$Bup), "\n")
}

}
